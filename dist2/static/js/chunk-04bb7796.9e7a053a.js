(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-04bb7796"],{2901:function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"search"},[r("label",{staticStyle:{color:"#666","font-size":"12px"}},[e._v("客户姓名：")]),r("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini",clearable:"",placeholder:"请输入客户姓名"},model:{value:e.guestName,callback:function(t){e.guestName=t},expression:"guestName"}}),r("label",{staticStyle:{color:"#666","font-size":"12px"}},[e._v("结账状态：")]),r("el-select",{staticStyle:{"margin-right":"10px"},attrs:{size:"mini",placeholder:"请选择结账状态",clearable:""},model:{value:e.resideStateId,callback:function(t){e.resideStateId=t},expression:"resideStateId"}},e._l(e.resideStateList,(function(e){return r("el-option",{key:e.resideStateId,attrs:{label:e.resideStateName,value:e.resideStateId}})})),1),r("el-button",{attrs:{type:"success",size:"mini"},on:{click:e.searchClick}},[e._v("查询")]),r("el-button",{attrs:{type:"success",size:"mini"},on:{click:e.excelClick}},[e._v("导出Excel")]),r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addclick}},[e._v("添加")])],1),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"mini"}},[r("el-table-column",{attrs:{label:"客户姓名",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.guestName)+" ")]}}])}),r("el-table-column",{attrs:{label:"客户电话",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.phone)+" ")]}}])}),r("el-table-column",{attrs:{label:"身份证号",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.identityId)+" ")]}}])}),r("el-table-column",{attrs:{label:"入住房间",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.roomId)+" ")]}}])}),r("el-table-column",{attrs:{label:"房间类型",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.room.roomType.roomTypeName)+" ")]}}])}),r("el-table-column",{attrs:{label:"床位数",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.room.roomType.bedNum)+" ")]}}])}),r("el-table-column",{attrs:{label:"房间价格",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.room.roomType.roomTypePrice)+" ")]}}])}),r("el-table-column",{attrs:{label:"入住日期",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.resideDate)+" ")]}}])}),r("el-table-column",{attrs:{label:"离开日期",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.leaveDate)+" ")]}}])}),r("el-table-column",{attrs:{label:"押金",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.deposit)+" ")]}}])}),r("el-table-column",{attrs:{label:"消费",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.totalMoney)+" ")]}}])}),r("el-table-column",{attrs:{label:"人数",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.guestNum)+" ")]}}])}),r("el-table-column",{attrs:{label:"状态",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tag",{attrs:{size:"mini",type:1===t.row.resideStateId?"danger":"success","disable-transitions":""}},[e._v(e._s(t.row.resideState.resideStateName)+" ")])]}}])}),r("el-table-column",{attrs:{label:"操作",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.resideStateId?r("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(r){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑 ")]):e._e(),1===t.row.resideStateId?r("el-button",{staticStyle:{color:"#E6A23C"},attrs:{size:"mini",type:"text"},on:{click:function(r){return e.handleJiezhang(t.$index,t.row)}}},[e._v("结账 ")]):e._e(),2===t.row.resideStateId?r("el-button",{staticStyle:{color:"#F56C6C"},attrs:{size:"mini",type:"text"},on:{click:function(r){return e.handleDelete(t.$index,t.row)}}},[e._v("删除 ")]):e._e()]}}])})],1),r("div",{staticClass:"flex j-c",staticStyle:{"margin-top":"5px"}},[r("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.count},on:{"current-change":e.currentChange}})],1),r("el-drawer",{attrs:{title:e.isadd?"添加顾客":"修改顾客",visible:e.drawer,direction:"rtl","before-close":e.drawerClose,size:"30%"},on:{"update:visible":function(t){e.drawer=t}}},[r("div",{staticStyle:{padding:"0 10px"}},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{size:"mini",model:e.ruleForm,"status-icon":"",rules:e.rules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"姓名",prop:"guestName"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.ruleForm.guestName,callback:function(t){e.$set(e.ruleForm,"guestName",t)},expression:"ruleForm.guestName"}})],1),r("el-form-item",{attrs:{label:"电话",prop:"phone"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.ruleForm.phone,callback:function(t){e.$set(e.ruleForm,"phone",t)},expression:"ruleForm.phone"}})],1),r("el-form-item",{attrs:{label:"身份证",prop:"identityId"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.ruleForm.identityId,callback:function(t){e.$set(e.ruleForm,"identityId",t)},expression:"ruleForm.identityId"}})],1),r("el-form-item",{attrs:{label:"客房类型",prop:"roomTypeId"}},[r("el-select",{attrs:{size:"mini",placeholder:"请选择客房类型",clearable:""},on:{change:e.roomTypeChange},model:{value:e.ruleForm.roomTypeId,callback:function(t){e.$set(e.ruleForm,"roomTypeId",t)},expression:"ruleForm.roomTypeId"}},e._l(e.roomTypeList,(function(e){return r("el-option",{key:e.roomTypeId,attrs:{label:e.roomTypeName,value:e.roomTypeId}})})),1)],1),r("el-form-item",{attrs:{label:"客房",prop:"roomId"}},[r("el-select",{attrs:{size:"mini",placeholder:"请选择客房",clearable:""},model:{value:e.ruleForm.roomId,callback:function(t){e.$set(e.ruleForm,"roomId",t)},expression:"ruleForm.roomId"}},e._l(e.roomList,(function(e){return r("el-option",{key:e.roomId,attrs:{label:e.roomId,value:e.roomId}})})),1)],1),r("el-form-item",{attrs:{label:"入住时间",prop:"resideDate"}},[r("el-date-picker",{attrs:{type:"datetime",placeholder:"请选择入住时间"},model:{value:e.ruleForm.resideDate,callback:function(t){e.$set(e.ruleForm,"resideDate",t)},expression:"ruleForm.resideDate"}})],1),r("el-form-item",{attrs:{label:"押金",prop:"deposit"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.ruleForm.deposit,callback:function(t){e.$set(e.ruleForm,"deposit",e._n(t))},expression:"ruleForm.deposit"}})],1),r("el-form-item",{attrs:{label:"入住人数",prop:"guestNum"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.ruleForm.guestNum,callback:function(t){e.$set(e.ruleForm,"guestNum",e._n(t))},expression:"ruleForm.guestNum"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v(e._s(e.isadd?"添加":"修改"))]),r("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("取消")])],1)],1)],1)])],1)},a=[],n=r("1da1"),s=(r("96cf"),r("d81d"),r("95f9")),i={name:"role",data:function(){var e=function(e,t,r){""===t?r(new Error("请输入身份证号")):r()},t=function(e,t,r){""===t?r(new Error("请输入顾客姓名")):r()},r=function(e,t,r){""===t?r(new Error("请输入手机号")):r()},o=function(e,t,r){""===t?r(new Error("请输入客房类型")):r()},a=function(e,t,r){""===t?r(new Error("请输入客房编号")):r()},n=function(e,t,r){""===t?r(new Error("请输入入住日期")):r()},s=function(e,t,r){""===t?r(new Error("请输入押金")):r()},i=function(e,t,r){""===t?r(new Error("请输入入住人数")):r()};return{tableData:[],count:0,guestName:"",resideStateId:"",resideStateList:[],roomTypeList:[],roomList:[],pageIndex:1,drawer:!1,isadd:!0,ruleForm:{identityId:"",guestName:"",phone:"",roomTypeId:"",roomId:"",resideDate:"",deposit:"",guestNum:""},rules:{identityId:[{validator:e,trigger:"blur"}],guestName:[{validator:t,trigger:"blur"}],phone:[{validator:r,trigger:"blur"}],roomTypeId:[{validator:o,trigger:"change"}],roomId:[{validator:a,trigger:"change"}],resideDate:[{validator:n,trigger:"blur"}],deposit:[{validator:s,trigger:"blur"}],guestNum:[{validator:i,trigger:"blur"}]}}},created:function(){this.getTableData(),this.getResideStateList(),this.getRoomTypeList()},methods:{excelClick:function(){var e=this.tableData.map((function(e){return{guestName:e.guestName,phone:e.phone,identityId:e.identityId,roomId:e.roomId,roomTypeName:e.room.roomType.roomTypeName,bedNum:e.room.roomType.bedNum,price:e.room.roomType.roomTypePrice,resideDate:e.resideDate,leaveDate:e.leaveDate,deposit:e.deposit,totalMoney:e.totalMoney,guestNum:e.guestNum,resideStateName:e.resideState.resideStateName}})),t={guestName:"客户姓名",phone:"客户电话",identityId:"身份证号",roomId:"入住房间",roomTypeName:"房间类型",bedNum:"床位数",price:"房间价格",resideDate:"入住日期",leaveDate:"离开日期",deposit:"押金",totalMoney:"消费金额",guestNum:"入住人数",resideStateName:"结账状态"},r="顾客信息表";Object(s["a"])(e,t,r)},getTableData:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$get("/GuestRecord/List",{pageIndex:e.pageIndex,resideStateId:e.resideStateId||0,guestName:e.guestName});case 2:r=t.sent,o=r.data,a=r.count,e.tableData=o,e.count=a;case 7:case"end":return t.stop()}}),t)})))()},currentChange:function(e){this.pageIndex=e,this.getTableData()},searchClick:function(){this.getTableData()},getResideStateList:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$get("/ResideState/List");case 2:r=t.sent,e.resideStateList=r;case 4:case"end":return t.stop()}}),t)})))()},getRoomTypeList:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$get("/RoomType/List");case 2:r=t.sent,e.roomTypeList=r;case 4:case"end":return t.stop()}}),t)})))()},roomTypeChange:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var o,a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e||(t.ruleForm.roomId=""),o=t.ruleForm.roomTypeId,!o){r.next=8;break}return r.next=5,t.$get("/Room/List",{roomTypeId:o,roomStateId:1,guestId:t.ruleForm.guestId||0});case 5:a=r.sent,n=a.data,t.roomList=n;case 8:case"end":return r.stop()}}),r)})))()},handleDelete:function(e,t){var r=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var o,a,n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r.$con_f("是否确定删除？");case 2:return o=t.guestId,e.next=5,r.$post("/GuestRecord/Delete",{guestId:o});case 5:a=e.sent,n=a.success,s=a.message,n?(r.$msg_s(s),r.getTableData()):r.$msg_e(s);case 9:case"end":return e.stop()}}),e)})))()},addclick:function(){this.drawer=!0},drawerClose:function(e){this.resetForm("ruleForm"),this.isadd=!0,e()},submitForm:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(r){var o,a,n,s,i,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!r){e.next=18;break}if(!t.isadd){e.next=10;break}return e.next=4,t.$post("/GuestRecord/Add",t.ruleForm);case 4:o=e.sent,a=o.success,n=o.message,a?(t.$msg_s(n),t.getTableData(),t.resetForm("ruleForm")):t.$msg_e(n),e.next=16;break;case 10:return e.next=12,t.$post("/GuestRecord/Update",t.ruleForm);case 12:s=e.sent,i=s.success,l=s.message,i?(t.$msg_s(l),t.getTableData()):t.$msg_e(l);case 16:e.next=19;break;case 18:return e.abrupt("return",!1);case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},resetForm:function(e){this.$refs[e].resetFields(),this.ruleForm={identityId:"",guestName:"",phone:"",roomTypeId:"",roomId:"",resideDate:"",deposit:"",guestNum:""}},handleEdit:function(e,t){var r=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var o,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=t.guestId,e.next=3,r.$get("/GuestRecord/GetOne",{guestId:o});case 3:a=e.sent,r.ruleForm=a,r.ruleForm.roomTypeId=a.room.roomTypeId,r.roomTypeChange(1),r.isadd=!1,r.drawer=!0;case 9:case"end":return e.stop()}}),e)})))()},handleJiezhang:function(e,t){var r=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var o,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r.$con_f("是否确定结账?");case 2:return o=t.guestId,e.next=5,r.$post("/GuestRecord/Checkout",{guestId:o});case 5:a=e.sent,n=a.totalMoney,r.$msg_s("结账成功！需要支付"+n+"元,客房费用！"),r.getTableData();case 9:case"end":return e.stop()}}),e)})))()}}},l=i,u=(r("3349"),r("0c7c")),c=Object(u["a"])(l,o,a,!1,null,"f4966034",null);t["default"]=c.exports},3349:function(e,t,r){"use strict";r("bee8")},bee8:function(e,t,r){}}]);